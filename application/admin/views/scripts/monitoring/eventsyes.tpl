<tr>
	<td>
		<h3>Мониторинг - список событий</h3>
	</td>
</tr>
<tr>
	<td>
	<script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script>
<script type="text/javascript" src="/scripts/jquery.js"></script>
<script type="text/javascript" src="/scripts/jquery-ui-1.7.3.custom.min.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.base.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.common.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.formedit.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.inlinedit.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.celledit.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.subgrid.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.treegrid.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.custom.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.postext.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.tbltogrid.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.setcolumns.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.import.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/jquery.fmatter.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.grouping.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/jqModal.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/jqDnR.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/JsonXml.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/grid.jqueryui.js"></script>
<script type="text/javascript" charset="utf-8" src="/scripts/js/jquery.searchFilter.js"></script>
		<div id='kontragent'>
			<table>
				<tr>
					<td>
					
						<table id="bigset"></table>
						<div id="pagerb"></div>
						<div id="pagerb_info"><button id='last'><<</button><button id='next'>>></button></div>
					   
						{literal}
			 
						<script src="/scripts/js/jquery-ui-1.8.2.custom.min.js" type="text/javascript"></script>
						<script src="/scripts/js/jquery.layout.js" type="text/javascript"></script>
						<script src="/scripts/js/i18n/grid.locale-ru.js" type="text/javascript"></script>

						<link rel="stylesheet" type="text/css" media="screen" href="/scripts/themes/redmond/jquery-ui-1.8.2.custom.css" />
						<link rel="stylesheet" type="text/css" media="screen" href="/scripts/themes/ui.jqgrid.css" />
						<link rel="stylesheet" type="text/css" media="screen" href="/scripts/themes/ui.multiselect.css" />
						<script src="/scripts/js/ui.multiselect.js" type="text/javascript"></script>
						<script src="/scripts/js/jquery.jqGrid.js" type="text/javascript"></script>

					
						<style type="text/css">
							.searchFLD {
								width:100px;
								
							}
						</style>
						<script type="text/javascript">
					//	alert('');
						var select_row_table = 0;
							$.jgrid.no_legacy_api = true;
							$.jgrid.useJSON = true;
						 setTimeout(function(){
						 jQuery("#bigset").jqGrid({
							url:'/admin/monitoring/kontrdata/?tarif={/literal}{$current_mon_tarif}{literal}',
							datatype: "json",
							height: 330,
							width: 450,
							colNames:['<input type=checkbox id="delallItem" name="delallItem">','Наименование', 'Регион', 'Адресс', 'ИНН', 'Статус'],
								colModel :[
									{name:'inp', index:'inp', width:20, align:'right', sortable:false}
									,{name:'title', index:'title', width:170, align:'right'}
									,{name:'region', index:'region', width:80, align:'right'}
									,{name:'adress', index:'adress', width:100}
									,{name:'inn', index:'inn', width:50}
									,{name:'status', index:'status', width:30, align:'right', sortable:false}
									],
							rowNum:20,
									rowList:[20,30,40],
							mtype: "POST",
							pager: jQuery('#pagerb'),
							pgbuttons: true,
							pgtext: false,
							pginput:false,
							sortname: 'title',
								sortorder: "desc",
								viewrecords: true,
								onSelectRow: gridReload2,
								//beforeRequest: function(){select_row_table = $('#bigset').jqGrid('getGridParam','selrow'); alert($('#bigset').jqGrid('getGridParam','selrow'));},
								loadComplete: function(){$('#bigset').jqGrid('setSelection',select_row_table);},
								//tarif: {/literal}{$current_mon_tarif}{literal},
						  
									});
								setTimeout(function(){	
								$('#bigset').jqGrid('navSeparatorAdd','#pagerb');
								$('#bigset').jqGrid('navButtonAdd','#pagerb',{
									caption: 'Закрутить ',
									title: 'Ключ рожковый, обыкновенный',
									buttonicon: 'ui-icon-wrench',
									onClickButton: function(){
											alert('Скрип, скрип, скрип!..');
										},
									position:'first'
								});	
							//	alert('ff');
								}, 2000);
							}, 2000);
								/*setTimeout(function(){	
								$('#bigset').jqGrid('navSeparatorAdd','#pagerb');
								$('#bigset').jqGrid('navButtonAdd','#pagerb',{
									caption: 'Закрутить ',
									title: 'Ключ рожковый, обыкновенный',
									buttonicon: 'ui-icon-wrench',
									onClickButton: function(){
											alert('Скрип, скрип, скрип!..');
										},
									position:'first'
								});	
								alert('ff');
								}, 4000);	*/
									var timeoutHnd;
									var flAuto = true;

									function doSearch(ev){
							if(!flAuto)
								return;
									//	var elem = ev.target||ev.srcElement;
							if(timeoutHnd)
								clearTimeout(timeoutHnd)
							timeoutHnd = setTimeout(gridReload,500)
									}

							function gridReload(){
									
							jQuery("#bigset").jqGrid('setGridParam',{url:"/admin/monitoring/kontrdata/"});
									}
									
									gridReload();
									
							$('input[name="filter_serch"]').click(function(){
								gridReload();
								return false;
							});
							
							$('input[name="filter_serch2"]').click(function(){
								 jQuery("#filter_inn").val('');
								 jQuery("#filter_name").val('');
								 jQuery("#filter_region").val('');
								 gridReload();
								 
								 return false;
									});
							
						
						$(document).ready(function() {
							$('#pagerb_info>#last').click(function(){
								alert('ff');
							});
							
						});
						</script>
						{/literal}
					</td>
					<td>
						<table id="bigset2"></table>
						<div id="pagerb2"></div>
						
						{literal}
						<script type="text/javascript">
					//	alert('');
							$.jgrid.no_legacy_api = true;
							$.jgrid.useJSON = true;
						 setTimeout(function(){
						 jQuery("#bigset2").jqGrid({
							url:'/admin/monitoring/eventdata/',
							datatype: "json",
							height: 330,
							width: 450,
							colNames:['<input type=checkbox id="delallItem" name="delallItem">','Событие', 'Тип', 'Источник', 'Дата', 'Пользователь', 'Статус'],
								colModel :[
									{name:'inp', index:'inp', width:20, align:'right', sortable:false}
									,{name:'content', index:'content', width:170, align:'right'}
									,{name:'event_type', index:'event_type', width:80, align:'right'}
									,{name:'istochnik', index:'istochnik', width:100}
									,{name:'date_do', index:'date_do', width:50}
									,{name:'user', index:'user', width:50}
									,{name:'status', index:'status', width:50, align:'right', sortable:false}
									],
							rowNum:20,
									rowList:[20,30,40],
							mtype: "POST",
							pager: jQuery('#pagerb2'),
							pgbuttons: true,
							pgtext: false,
							pginput:false,
							sortname: 'content',
								sortorder: "desc",
								viewrecords: true,
								//tarif: {/literal}{$current_mon_tarif}{literal},
						  
									});
									}, 2000);
									var timeoutHnd;
									var flAuto = true;

									function doSearch(ev){
							if(!flAuto)
								return;
									//	var elem = ev.target||ev.srcElement;
							if(timeoutHnd)
								clearTimeout(timeoutHnd)
							timeoutHnd = setTimeout(gridReload2,500)
									}

									function gridReload2(){
									
							//alert('111');
							//alert($('#bigset').jqGrid('getGridParam','selrow'));
							select_row_table = $('#bigset').jqGrid('getGridParam','selrow');
							jQuery("#bigset2").jqGrid('setGridParam',{url:"/admin/monitoring/eventdata/?kid="+$('#bigset').jqGrid('getGridParam','selrow')}).trigger("reloadGrid");
									}
									gridReload2()
							$('input[name="filter_serch"]').click(function(){
								gridReload2();
								return false;
							});
							$('input[name="filter_serch2"]').click(function(){
								 jQuery("#filter_inn").val('');
								 jQuery("#filter_name").val('');
								 jQuery("#filter_region").val('');
								 gridReload2();
								 
								 return false;
									});
							$('#jqgh_del').live('click', function(){
								alert('ff');
								/*if ($(this).attr('checked') == true)
									$('input[name="delItem[]"]').attr('checked', 'checked');
								else
									$('input[name="delItem[]"]').attr('checked', '');
								//	$('#delallItem').attr('checked', 'checked');*/
							});
						</script>
						{/literal}
					</td>
				</tr>
			</table>
		</div>
		
	</td>
</tr>
{*$LISTER_OUTPUT*}
